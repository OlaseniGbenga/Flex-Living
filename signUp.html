<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>

<body>

    <header style="height: 100px; background-color: darkseagreen; padding: 10px;">
        <nav style="display: flex; justify-content: space-between;">
            <h2 style="color: wheat; margin-left: 30px;">Sign Up</h2>
            <button class="btn btn-warning">Home</button>
        </nav>
    </header>


    <div class="container">
        <h5 class="mt-5">Sign Up</h5>
        <form id="signUpForm">
            <div class="form-group">
                <label for="name">Name: </label>
                <input type="text" class="form-control" name="name" aria-describedby="emailHelp"
                    placeholder="Enter your full name" required>
            </div>
            <div class="form-group">
                <label for="email">Email address</label>
                <input type="text" class="form-control" name="email" aria-describedby="emailHelp"
                    placeholder="Enter email">
                <small id="emailError" class="form-text d-none text-danger">We'll never share your email with anyone
                    else.</small>
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" class="form-control" name="password" placeholder="Password">
                <small id="passwordError" class="form-text d-none text-danger">We'll never share your email with anyone
                    else.</small>
            </div>
            <div class="form-group">
                <label for="address" class="form-label">Address: </label>
                <textarea class="form-control" name="address" rows="3"></textarea>
            </div>
            <div class="form-check">
                <input type="checkbox" class="form-check-input" id="exampleCheck1">
                <label class="form-check-label" for="exampleCheck1">Check me out</label>
            </div>
            <p id="errorMessage" class="form-text d-none text-danger">We'll never share your email with anyone
                else.</p>
            <button id="submitBTN" type="submit" class="btn btn-primary">
                <span id="spinner" class="d-none">
                    <div class="spinner-border spinner-border-sm" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </span>
                Submit
            </button>
        </form>
    </div>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, sendEmailVerification } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        import { getFirestore, collection, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCGABr3IRTem8rPa9rLnqZNu1siNlPPgN4",
            authDomain: "bj-blog-fbf8d.firebaseapp.com",
            projectId: "bj-blog-fbf8d",
            storageBucket: "bj-blog-fbf8d.appspot.com",
            messagingSenderId: "946369142338",
            appId: "1:946369142338:web:e9fb38c3d5fa5b118097db"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        //Init Auth
        const auth = getAuth(app);
        //init firestore
        const db = getFirestore(app);
        //colref
        const userColRef = collection(db, 'users');

        signUpForm.addEventListener('submit', createUserAccunt);

        async function createUserAccunt(event) {
            event.preventDefault();
            const userDetails = {
                name: signUpForm.name.value,
                email: signUpForm.email.value,
                address: signUpForm.address.value
            }
            const password = signUpForm.password.value;

            try {
                const userCred = await createUserWithEmailAndPassword(auth, userDetails.email, password);
                const docRef = doc(userColRef, userCred.user.uid);
                await setDoc(docRef, userDetails);
                await sendEmailVerification(userCred.user);
                alert('Account created successfully');
            } catch (error) {
                console.log(error);
            }
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
</body>

</html>